BACKUP KODE FARELL

MAIN.C

#include "atm.h"
#include <stdlib.h>

int main() {
    Rekening akunAktif;
    char username[50], password[50];
    int pilihan, jumlah;
    char pinBaru[50];
	
	system("color 1F");
	clearScreen();	
	printf("\033[44m\033[37m");
	printf("=============================================\n");
	printf(" SSSSS   EEEEE   DDDD    EEEEE   PPPPP\n");
    printf("S        E       D   D   E       P   P\n");
    printf(" SSSSS   EEEE    D   D   EEEE    PPPPP\n");
    printf("      S  E       D   D   E       P\n");
    printf(" SSSSS   EEEEE   DDDD    EEEEE   P\n");
    printf("=============================================\n");
    printf("Selamat datang di ATM!\n");
    printf("Masukkan username: ");
    scanf("%s", username);
    printf("Masukkan password: ");
    scanf("%s", password);
	
    if (autentikasi(&akunAktif, username, password)) {
        printf("Login berhasil!\n");
        do {
        	clearScreen();
            tampilkanMenuAwal();
            printf("Pilih menu: ");
            scanf("%d", &pilihan);

            switch (pilihan) {
                case 1:
                	clearScreen();
                    cekSaldo(&akunAktif);
                    system("pause");
                    break;
                case 2:
                	clearScreen();
                    printf("Masukkan jumlah tarik tunai: ");
                    scanf("%d", &jumlah);
                    tarikTunai(&akunAktif, jumlah);
                    system("pause");
                    break;
                case 3:
                	clearScreen();
                    printf("Masukkan PIN baru: ");
                    scanf("%s", pinBaru);
                    gantiPIN(&akunAktif, pinBaru);
                    system("pause");
                    break;
                case 4:
                	clearScreen();
                    printf("Terima kasih telah menggunakan layanan kami!\n");
                    system("pause");
                    break;
                default:
                	clearScreen();
                    printf("Pilihan tidak valid!\n");
                    system("pause");
            }
        } while (pilihan != 4);
    } else {
    	clearScreen();
        printf("Username atau password salah!\n");
        system("pause");
    }
    printf("\033[0m");
    return 0;
}

ATM.C

#include "atm.h"
#include <stdio.h>
#include <string.h>
#include <windows.h>

void tampilkanMenuAwal() {
    printf("===== SEDEP ATM =====\n");
    printf("1. Cek Saldo\n");
    printf("2. Tarik Tunai\n");
    printf("3. Ganti PIN\n");
    printf("4. Keluar\n");
    printf("======================\n");
}

void tarikTunai(Rekening *rek, int jumlah) {
    if (rek->saldo >= jumlah) {
        rek->saldo -= jumlah;
        printf("Tarik tunai berhasil! Sisa saldo Anda: %d\n", rek->saldo);

        if (updateFileRekening(rek)) {
            printf("Data rekening berhasil diperbarui!\n");
        } else {
            printf("Gagal memperbarui data rekening!\n");
        }
    } else {
        printf("Saldo tidak cukup!\n");
    }
}

void gantiPIN(Rekening *rek, const char *pinBaru) {
    strcpy(rek->password, pinBaru);
    printf("PIN berhasil diganti!\n");

    if (updateFileRekening(rek)) {
        printf("Data rekening berhasil diperbarui!\n");
    } else {
        printf("Gagal memperbarui data rekening!\n");
    }
}

void cekSaldo(const Rekening *rek) {
    printf("Saldo Anda saat ini: %d\n", rek->saldo);
}

int autentikasi(Rekening *rek, const char *username, const char *password) {
    FILE *file = fopen("daftarrekening.txt", "r");
    if (!file) {
        printf("File tidak ditemukan!\n");
        return 0;
    }
    while (fscanf(file, "%s %s %d", rek->username, rek->password, &rek->saldo) != EOF) {
        if (strcmp(rek->username, username) == 0 && strcmp(rek->password, password) == 0) {
            fclose(file);
            return 1;
        }
    }
    fclose(file);
    return 0;
}

int updateFileRekening(const Rekening *rek) {
    FILE *file = fopen("daftarrekening.txt", "r");
    FILE *temp = fopen("temp.txt", "w");
    if (!file || !temp) {
        if (file) fclose(file);
        if (temp) fclose(temp);
        return 0;
    }

    Rekening tempRek;
    int updated = 0;

    while (fscanf(file, "%s %s %d", tempRek.username, tempRek.password, &tempRek.saldo) != EOF) {
        if (strcmp(tempRek.username, rek->username) == 0) {
            fprintf(temp, "%s %s %d\n", rek->username, rek->password, rek->saldo);
            updated = 1;
        } else {
            fprintf(temp, "%s %s %d\n", tempRek.username, tempRek.password, tempRek.saldo);
        }
    }

    fclose(file);
    fclose(temp);

    if (updated) {
        remove("daftarrekening.txt");
        rename("temp.txt", "daftarrekening.txt");
    }

    return updated;
}

void clearScreen() {
    system("cls");
}

ATM.H

#ifndef ATM_H
#define ATM_H

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct {
    char username[50];
    char password[50];
    int saldo;
} Rekening;

void tampilkanMenuAwal();
void tarikTunai(Rekening *rek, int jumlah);
void gantiPIN(Rekening *rek, const char *pinBaru);
void cekSaldo(const Rekening *rek);
int autentikasi(Rekening *rek, const char *username, const char *password);
int updateFileRekening(const Rekening *rek);
void clearScreen();

#endif
